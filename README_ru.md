# PPM - VBA Package Manager

\[[eng](README.md)\]\[rus\]

![GitHub-Mark-Light](./assets/white.jpg#gh-light-mode-only)![GitHub-Mark-Dark](./assets/black.jpg#gh-dark-mode-only)

[Подарить мне кофеек](https://donate.stream/donate_668a7791e2948)

`ppm` - это менеджер пакетов, разработанный для VBA и на VBA, предоставляющий CLI-подобный интерфейс через Immediate Window в VBA IDE. Он создан, чтобы помочь разработчикам управлять своими VBA-проектами, упорядочивая код, зависимости и облегчая выполнение общих задач.

## Список команд

В настоящее время `ppm` поддерживает несколько команд:

- [`init`](#init): Инициализирует пакет.
- [`publish`](#publish): Загружает проект на сервер или в локальный реестр.
- [`install`](#install): Устанавливает пакеты с зависимостями в проект.
- [`uninstall`](#uninstall): Удаляет пакеты с зависимостями из проекта, если они не используются другими зависимостями.
- [`export`](#export): Экспортирует модули в корневую папку проекта.
- [`sync`](#sync): Синхронизирует модули проекта с корневой папкой.
- [`config`](#config): Управляет настройками.
- [`version`](#version): Устанавливает новую версию пакета.
- [`help`](#help): Предоставляет справочную информацию и описания команд.

## Команды

### init
[`#список команд`](#список-команд)

#### Использование:
ppm "init \[options\]"

ppm "init"

Создает модуль 'package' с базовой информацией о пакете.

#### Флаги:
-y|--yes Пропускает диалог и устанавливает значения по умолчанию.

-n|--name Устанавливает значение для названия проекта.

**Пример**:
```vb
ppm "init -y"
```

**Результат**:
```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:
```vb
ppm "init -n MyPack -y"
```

**Результат**:
```json
// package.bas
'@Folder("MyPackProject")
'{
'  "name": "MyPack",
'  "version": "1.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

### publish
[`#список команд`](#список-команд)

#### Использование:
ppm "publish \[options\]"

Загружает проект на сервер или в локальный реестр.

#### Флаги:
-l|--local Публикует пакет в локальном реестре.

-r|--registry Указывает путь или URL реестра.

**Пример**:
```vb
ppm "publish -l"
```

**Результат**:
Публикует пакет в локальном реестре.

**Пример**:
```vb
ppm "publish -r http://example.com/registry"
```

**Результат**:
Публикует пакет в указанный URL реестра.

### install
[`#список команд`](#список-команд)

#### Использование:
ppm "install \[options\] \[package\[@version\]\]"

Устанавливает пакеты с зависимостями в проект.

#### Флаги:
-l|--local Устанавливает пакеты и зависимости из локального реестра.
 
-r|--registry Указывает путь или URL реестра.

**Пример**:
```vb
ppm "install pstrings"
```

**Результат**:
Устанавливает последнюю версию pstrings из реестра по умолчанию.

**Пример**:
```vb
ppm "install pstrings@4.17.21 -l"
```

**Результат**:
Устанавливает версию 4.17.21 pstrings из локального реестра.

### uninstall
[`#список команд`](#список-команд)

#### Использование:
ppm "uninstall \[package\]"

Удаляет пакеты с зависимостями из проекта, если они не используются другими пакетами.

**Пример**:
```vb
ppm "uninstall pstrings"
```

**Результат**:
Удаляет пакет pstrings из проекта.

### export
[`#список команд`](#список-команд)

#### Использование:
ppm "export \[options\]"

Экспортирует модули в корневую папку проекта.

#### Флаги:
-e|--encoding Указывает кодировку для экспортируемых файлов.

-s|--save-struct Сохраняет структуру RubberDuck при экспорте проекта.

-p|--path Указывает папку для экспорта.

-nc|--no-clear Не удаляет файлы из последнего экспорта.

**Пример**:
```vb
ppm "export -p ./dist -e UTF-8"
```

**Результат**:
Экспортирует файлы проекта в директорию './dist' с кодировкой UTF-8.

### sync
[`#список команд`](#список-команд)

#### Использование:
ppm "sync \[options\]"

Синхронизирует модули проекта с корневой папкой.

**Пример**:
```vb
ppm "sync"
```

**Результат**:
Синхронизирует все модули проекта с файлами из корневой папки.

### config
[`#список команд`](#список-команд)

#### Использование:
ppm "config \<subcommand\> \[options\]"

Управляет файлом настроек ppm.

#### Флаги:
-g|--global Использует глобальные настройки.

-l|--location Указывает расположение конфигурации.

**Пример**:
```vb
ppm "config set key=value"
```

**Результат**:
Устанавливает значение конфигурации для указанного ключа.

**Пример**:
```vb
ppm "config get key"
```

**Результат**:
Получает значение конфигурации для указанного ключа.

**Пример**:
```vb
ppm "config delete key"
```

**Результат**:
Удаляет запись конфигурации для указанного ключа.

**Пример**:
```vb
ppm "config edit"
```

**Результат**:
Открывает файл конфигурации для редактирования.

### version
[`#список команд`](#список-команд)

#### Использование:
ppm "version \<new version | major | minor | patch\>"

Устанавливает новую версию пакета.

**Пример**:
```vb
ppm "version 1.1.1"

' Вывод: v1.1.1
```

**Результат**:
```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.1.1",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:
```vb
ppm "version patch"

' Вывод: v1.1.2
```

**Результат**:
```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.1.2",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:
```vb
ppm "version minor"

' Вывод: v1.2.0
```

**Результат**:
```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.2.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:
```vb
ppm "version major"

' Вывод: v2.0.0
```

**Результат**:
```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "2.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

### help
[`#список команд`](#список-команд)

#### Использование:
ppm "help \[command\]"

Предоставляет справочную информацию и описания команд.

#### Пример:
```vb
ppm "help init"
```

**Результат**:
Показывает информацию о команде `init`.

**Общий пример**:
```vb
ppm "help"
```

**Результат**:
Показывает общую справочную информацию и доступные команды.

## Вклад

Любой вклад в `ppm` приветствуется. Чтобы сделать вклад, пожалуйста, отправьте pull request с подробным объяснением ваших предложенных изменений или улучшений.

## Лицензия

Менеджер пакетов `ppm` для VBA является открытым программным обеспечением и доступен по лицензии MIT.
