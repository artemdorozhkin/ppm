# PPM - VBA Package Manager

\[[eng](README.md)\]\[rus\]

![GitHub-Mark-Light](./assets/white.jpg#gh-light-mode-only)![GitHub-Mark-Dark](./assets/black.jpg#gh-dark-mode-only)

[Подарить мне кофеек](https://donate.stream/donate_668a7791e2948)

`ppm` - это менеджер пакетов, разработанный для VBA и на VBA, предоставляющий CLI-подобный интерфейс через Immediate Window в VBA IDE. Он создан, чтобы помочь разработчикам управлять своими VBA-проектами, упорядочивая код, зависимости и облегчая выполнение общих задач.

## Добавление в проект

Чтобы добавить надстройку в проект:

1. **Убедитесь, что открыто окно Excel** (активно именно оно, а не редактор VBA).

1. Нажмите `Ctrl + Shift + A` для добавления `ppm` в свой проект.

## Список команд

В настоящее время `ppm` поддерживает несколько команд:

- [`class`](#class): Управляет классами проекта (.cls).
- [`config`](#config): Управляет настройками.
- [`export`](#export): Экспортирует модули в корневую папку проекта.
- [`help`](#help): Предоставляет справочную информацию и описания команд.
- [`init`](#init): Инициализирует пакет.
- [`install`](#install): Устанавливает пакеты с зависимостями в проект.
- [`module`](#module): Управляет модулями проекта (.bas).
- [`publish`](#publish): Загружает проект на сервер или в локальный реестр.
- [`search`](#search): Поиск пакета на сервере или локально.
- [`sync`](#sync): Синхронизирует модули проекта с корневой папкой.
- [`uninstall`](#uninstall): Удаляет пакеты с зависимостями из проекта, если они не используются другими зависимостями.
- [`version`](#version): Устанавливает новую версию пакета.

## Команды

### class

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "class \[subcommand\] \<path\> [options]"

Управляет классами проекта (.cls).

#### Флаги:

-c|--create-constructor Создать модуль конструктор для класса.

**Пример**:

```vb
ppm "class add NewClass"
' или просто
ppm "cls NewClass"
```

**Результат**:
Добавляет класс NewClass в проект.

**Пример**:

```vb
ppm "class add NewClass --create-constructor"
' или просто
ppm "cls NewClass -c"
```

**Результат**:
Добавляет класс NewClass, а так же модуль конструктор NewClassCstr в проект.
Если класс уже существует, добавляет только модуль конструктор.

**Пример**:

```vb
ppm "class move /path/SomeClass"
' или просто
ppm "cls mv /path/SomeClass"
```

**Результат**:
Перемещает SomeClass и его модуль конструктор, если он есть, в RD директорию ‘path’.

**Пример**:

```vb
ppm "class delete /path/SomeClass"
' или просто
ppm "cls delete /path/SomeClass"
```

**Результат**:
Удаляет SomeClass и его модуль конструктор, если он есть.

### config

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "config \<subcommand\> \[options\]"

Управляет файлом настроек ppm.

#### Флаги:

-g|--global Использует глобальные настройки.

-l|--location Указывает расположение конфигурации.

**Пример**:

```vb
ppm "config set key=value"
```

**Результат**:
Устанавливает значение конфигурации для указанного ключа.

**Пример**:

```vb
ppm "config get key"
```

**Результат**:
Получает значение конфигурации для указанного ключа.

**Пример**:

```vb
ppm "config delete key"
```

**Результат**:
Удаляет запись конфигурации для указанного ключа.

**Пример**:

```vb
ppm "config edit"
```

**Результат**:
Открывает файл конфигурации для редактирования.

### export

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "export \[options\]"

Экспортирует модули в корневую папку проекта.

#### Флаги:

-e|--encoding Указывает кодировку для экспортируемых файлов.

-s|--save-struct Сохраняет структуру RubberDuck при экспорте проекта.

-p|--path Указывает папку для экспорта.

-nc|--no-clear Не удаляет файлы из последнего экспорта.

**Пример**:

```vb
ppm "export -p ./dist -e UTF-8"
```

**Результат**:
Экспортирует файлы проекта в директорию './dist' с кодировкой UTF-8.

### help

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "help \[command\]"

Предоставляет справочную информацию и описания команд.

#### Пример:

```vb
ppm "help init"
```

**Результат**:
Показывает информацию о команде `init`.

**Общий пример**:

```vb
ppm "help"
```

**Результат**:
Показывает общую справочную информацию и доступные команды.

### init

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "init \[options\]"

ppm "init"

Создает модуль 'package' с базовой информацией о пакете.

#### Флаги:

-y|--yes Пропускает диалог и устанавливает значения по умолчанию.

-n|--name Устанавливает значение для названия проекта.

**Пример**:

```vb
ppm "init -y"
```

**Результат**:

```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:

```vb
ppm "init -n MyPack -y"
```

**Результат**:

```json
// package.bas
'@Folder("MyPackProject")
'{
'  "name": "MyPack",
'  "version": "1.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

### install

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "install \[options\] \[package\[@version\]\]"

Устанавливает пакеты с зависимостями в проект.

#### Флаги:

-l|--local Устанавливает пакеты и зависимости из локального реестра.

-r|--registry Указывает путь или URL реестра.

**Пример**:

```vb
ppm "install pstrings"
```

**Результат**:
Устанавливает последнюю версию pstrings из реестра по умолчанию.

**Пример**:

```vb
ppm "install pstrings@4.17.21 -l"
```

**Результат**:
Устанавливает версию 4.17.21 pstrings из локального реестра.

### module

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "module \[subcommand\] \<path\>"

Управляет модулями проекта (.bas).

**Пример**:

```vb
ppm "module add NewModule"
' или просто
ppm "m NewModule"
```

**Результат**:
Добавляет модуль NewModule в проект.

**Пример**:

```vb
ppm "module move /path/SomeModule"
' или просто
ppm "m mv /path/SomeModule"
```

**Результат**:
Перемещает SomeModule в RD директорию ‘path’.

**Пример**:

```vb
ppm "module delete /path/SomeModule"
' или просто
ppm "m delete SomeModule"
```

**Результат**:
Удаляет SomeModule.

### publish

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "publish \[options\]"

Загружает проект на сервер или в локальный реестр.

#### Флаги:

-l|--local Публикует пакет в локальном реестре.

-r|--registry Указывает путь или URL реестра.

**Пример**:

```vb
ppm "publish -l"
```

**Результат**:
Публикует пакет в локальном реестре.

**Пример**:

```vb
ppm "publish -r http://example.com/registry"
```

**Результат**:
Публикует пакет в указанный URL реестра.

### search

[`⤴️commands list`](#commands-list)

#### Использование:

ppm "search \<package name\>"

Поиск пакета на сервере или локально.

#### Флаги:

-l|--local Поиск пакета в локальном реестре.

-r|--registry Указывает путь или URL реестра.

#### Привер:

```vb
ppm "search array --local"
```

**Результат**:

```vb
NAME      | VERSION | AUTHOR         | DESCRIPTION          |
ArrayList | 0.5.0   | artemdorozhkin | ppm is a package ... |
PArrays   | 2.0.0   |                |                      |
```

### sync

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "sync \[options\]"

Синхронизирует модули проекта с корневой папкой.

**Пример**:

```vb
ppm "sync"
```

**Результат**:
Синхронизирует все модули проекта с файлами из корневой папки.

### uninstall

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "uninstall \[package\]"

Удаляет пакеты с зависимостями из проекта, если они не используются другими пакетами.

**Пример**:

```vb
ppm "uninstall pstrings"
```

**Результат**:
Удаляет пакет pstrings из проекта.

### version

[`⤴️список команд`](#список-команд)

#### Использование:

ppm "version \<new version | major | minor | patch\>"

Устанавливает новую версию пакета.

**Пример**:

```vb
ppm "version 1.1.1"

' Вывод: v1.1.1
```

**Результат**:

```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.1.1",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:

```vb
ppm "version patch"

' Вывод: v1.1.2
```

**Результат**:

```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.1.2",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:

```vb
ppm "version minor"

' Вывод: v1.2.0
```

**Результат**:

```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "1.2.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

**Пример**:

```vb
ppm "version major"

' Вывод: v2.0.0
```

**Результат**:

```json
// package.bas
'@Folder("PearPMProject")
'{
'  "name": "PearPM",
'  "version": "2.0.0",
'  "description": "",
'  "author": "",
'  "git": ""
'}
```

## Вклад

Любой вклад в `ppm` приветствуется. Чтобы сделать вклад, пожалуйста, отправьте pull request с подробным объяснением ваших предложенных изменений или улучшений.

## Лицензия

Менеджер пакетов `ppm` для VBA является открытым программным обеспечением и доступен по лицензии MIT.
